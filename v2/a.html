<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unofficial HideySMP</title>
    <link rel="icon" type="image/png" href="https://eu.mc-api.net/v3/server/favicon/mc.pequla.one">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div id="loading">
            <h1 class="fw-bold text-center">Loading...</h1>
        </div>
        <div id="error" hidden>
            <h1 class="text-danger text-center">Server is offline</h1>
            <p id="message" class="text-center"></p>
        </div>
        <div id="status" hidden>
            <!-- Players -->
            <h1>Players:</h1>
            <p>Currently <span id="online" class="fw-bold"></span> out of <span id="max" class="fw-bold"></span> players online</p>
            <div>
                <ul id="list" class="list-unstyled"></ul>
            </div>
    
            <!-- World -->
            <h1>World:</h1>
            <p>Seed: <span id="seed" class="fw-bold"></span></p>
            <p>Type: <span id="type" class="fw-bold"></span></p>
            <p>Time: <span id="time" class="fw-bold"></span></p>
    
            <!-- Plugins -->
            <h1>Plugins:</h1>
            <ul id="plugins" class="list-unstyled"></ul>
    
            <!-- Server -->
            <h1>Server:</h1>
            <p>Version: <span id="version" class="fw-bold"></span></p>
            <p>Discord Invite: <a href="https://discord.gg/NFXpeHKZfz" class="fw-bold">discord.gg/NFXpeHKZfz</a></p>
        </div>
    </div>
    <template id="player-template">
        <li>
            <img class="player-icon">
            <span class="player-username fw-bold"></span> [Discord: <span class="player-discord"></span>]
        </li>
    </template>
    <script>
        const loading = document.getElementById('loading');
        const list = document.getElementById('list');
        const template = document.getElementById('player-template');
        fetch('https://api.pequla.one/api/status')
            .then(rsp => rsp.json())
            .then(data => {
                // Status
                loading.hidden = true;
                document.getElementById('status').hidden = false;
                document.getElementById('online').innerText = data.players.online;
                document.getElementById('max').innerText = data.players.max;
                data.players.list.forEach(player => {
                    fetch('https://api.pequla.one/api/user?uuid=' + player.id)
                        .then(drsp => drsp.json())
                        .then(discord => {
                            const copy = template.content.cloneNode(true);
                            const icon = copy.querySelector('.player-icon');
                            icon.src = 'https://visage.surgeplay.com/face/64/' + player.id;
                            icon.alt = player.name;
                            copy.querySelector('.player-username').innerText = player.name;
                            copy.querySelector('.player-discord').innerText = discord.name;
                            list.appendChild(copy);
                        });
                });;

                // World
                document.getElementById('seed').innerText = data.world.seed;
                document.getElementById('type').innerText = data.world.type;
                document.getElementById('time').innerText = data.world.time;

                // Plugins
                const plugins = document.getElementById('plugins');
                data.plugins.forEach(plugin => {
                    const li = document.createElement('li');
                    li.innerText = plugin;
                    li.classList.add('fw-bold');
                    plugins.appendChild(li);
                });

                // Server
                document.getElementById('version').innerText = data.version;
            })
            .catch(e=>{
                loading.hidden = true;
                document.getElementById('error').hidden = false;
                document.getElementById('message').innerText = e.message;
            });
    </script>
</body>

</html>